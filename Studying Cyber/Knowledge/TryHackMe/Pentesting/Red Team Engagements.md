### **Red Team Engagements: Task 1 - Introduction**

A successful red team engagement hinges on **well-coordinated planning** and **clear communication** among all parties involved. The purpose of such engagements is to simulate adversarial tactics to assess and improve the defensive capabilities of an organization.

---

#### **Types of Red Team Engagements**

1. **Tabletop Exercises**
    - Hypothetical discussions to evaluate responses to potential threats.
2. **Adversary Emulation**
    - Simulating real-world attacker TTPs (Tactics, Techniques, and Procedures).
3. **Physical Assessment**
    - Testing physical security measures like access controls, RFID badges, or lockpicking.

---

#### **Learning Objectives**

- **Understand Engagement Components:**  
    Identify the elements that constitute a red team operation.
- **Plan Engagements Effectively:**  
    Tailor engagements based on the organization's resources, needs, and likely adversarial TTPs.
- **Document Engagements Appropriately:**  
    Produce thorough reports and documentation that align with the client's objectives and expectations.

---

#### **Key Takeaway**

Red team engagements are versatile exercises aimed at enhancing an organization's security posture by evaluating their defenses against realistic threat scenarios. No prior knowledge is required to understand these principles.



### **Summary: Task 2 - Defining Scope and Objectives**

A successful red team engagement relies on clearly defined client objectives and scope:

1. **Objectives**:
    
    - Define the client's goals for the engagement, such as identifying vulnerabilities or testing security measures.
    - These set the foundation for engagement documentation and planning.
    - Objectives determine whether the engagement is a general penetration test or a focused adversary emulation.
2. **Scope**:
    
    - Specifies what is allowed or restricted during the engagement.
    - It includes explicit boundaries (e.g., systems or IP ranges to include or exclude) and rules (e.g., no data exfiltration or downtime).
    - The client sets the scope, while the red team ensures it aligns with the engagement objectives.

Both objectives and scope ensure the engagement is structured, focused, and aligned with the client’s expectations while avoiding disruptions or ethical violations.

---

### **Summary: Task 3 - Rules of Engagement (RoE)**

The **Rules of Engagement (RoE)** is a legally binding document that outlines the agreement between the client and the red team. It serves as the first formal document in the engagement planning process and establishes clear expectations, legal frameworks, and operational boundaries.

#### **Key Components of the RoE**

1. **Executive Summary**: Provides a high-level overview and authorization details.
2. **Purpose**: States why the RoE is necessary.
3. **References**: Lists any external standards or regulations referenced (e.g., HIPAA, ISO).
4. **Scope**: Outlines agreed-upon restrictions, guidelines, and boundaries for the engagement.
5. **Definitions**: Clarifies technical terms used in the document.
6. **Rules of Engagement and Support Agreement**: Defines obligations, technical expectations, and conduct for both parties.
7. **Provisions**: Details exceptions or additional clauses.
8. **Requirements, Restrictions, and Authority**: Specifies red team responsibilities and limitations.
9. **Ground Rules**: Lists strict limitations on red team interactions.
10. **Resolution of Issues/Points of Contact**: Identifies key personnel involved in the engagement.
11. **Authorization**: Confirms client approval for the engagement.
12. **Approval**: Contains signatures from both parties to finalize the document.
13. **Appendix**: Includes supplementary information not covered in other sections.

#### **Purpose of the RoE**

- Legally protects both parties by setting expectations and guidelines.
- Serves as a foundational agreement for further engagement planning.
- Ensures transparency, accountability, and adherence to ethical and legal standards.

---


### **Summary: Task 4 - Campaign Planning**

Campaign planning transitions the focus from business-level engagement documentation to the **technical and operational strategies** the red team will implement. Using the client objectives and Rules of Engagement (RoE) as a foundation, the campaign planning process creates actionable, detailed plans to guide the red team's activities.

#### **Key Components of Campaign Planning**

Campaign planning involves four primary types of plans, each increasing in detail and specificity:

1. **Engagement Plan**
    
    - **Purpose**: High-level description of the red team’s technical requirements.
    - **Contents**: Includes Concept of Operations (CONOPS), resource and personnel needs, and engagement timelines.
2. **Operations Plan**
    
    - **Purpose**: Expands on the Engagement Plan with more specifics.
    - **Contents**: Details operators, known information about the target, responsibilities, and other specifics.
3. **Mission Plan**
    
    - **Purpose**: Provides a step-by-step guide for engagement execution.
    - **Contents**: Lists exact commands to execute, time-based objectives, and assigned operators.
4. **Remediation Plan**
    
    - **Purpose**: Outlines post-engagement actions.
    - **Contents**: Covers reporting, remediation consultation, and any required follow-ups.

#### **Alternate Campaign Planning Approaches**

- An alternative to the detailed plan structure is the **redteam.guide engagement checklist**,  The checklist, found [here](https://redteam.guide/docs/checklists/red-team-checklist/), a generalized framework that provides flexibility while ensuring the inclusion of key planning elements.

#### **Importance of Campaign Planning**

- Ensures clarity and precision in communication within the red team.
- Facilitates well-documented and methodical execution of campaigns.
- Provides a structured framework for addressing client objectives and operational challenges.

---

#### **Q&A**

**Q1: What is the purpose of the Engagement Plan?**  
**A:** The Engagement Plan provides a high-level description of the red team’s technical requirements, including CONOPS, resources, personnel needs, and timelines.

**Q2: What type of plan details the specific commands to execute and the responsible operators?**  
**A:** The **Mission Plan**.

**Q3: Which plan focuses on post-engagement actions like reporting and remediation consultation?**  
**A:** The **Remediation Plan**.

**Q4: What is an alternative approach to detailed campaign planning?**  
**A:** The **redteam.guide engagement checklist**, which offers a more generalized planning framework.

### **Summary: Task 5 - Engagement Documentation**

Engagement documentation formalizes the strategies outlined during campaign planning, serving as an official record of the red team’s approach and execution. These documents range from detailed plans to simple communications like emails, depending on the engagement’s complexity.

#### **Components of Engagement Documentation**

1. **Engagement Plan**
    
    - **CONOPS (Concept of Operations)**: A non-technical explanation of how the red team will achieve client objectives and target the client.
    - **Resource Plan**: Lists required resources, including personnel, hardware, cloud infrastructure, and timelines for the campaign.
2. **Operations Plan**
    
    - **Personnel**: Specifies red team employee requirements.
    - **Stopping Conditions**: Outlines scenarios where the red team should halt operations.
    - **RoE (Rules of Engagement)**: (Optional) Reiterates agreed-upon restrictions and guidelines.
    - **Technical Requirements**: Defines the knowledge and skills needed for a successful engagement.
3. **Mission Plan**
    
    - **Command Playbooks**: (Optional) Detailed scripts of commands and tools to be used, tailored for teams with varying skill levels.
    - **Execution Times**: Specifies when to start and complete each engagement phase, including exact tool and command execution times.
    - **Responsibilities/Roles**: Assigns specific tasks and roles to team members.
4. **Remediation Plan** (Optional)
    
    - **Report**: Summarizes engagement details and findings.
    - **Remediation/Consultation**: Advises the client on addressing vulnerabilities. This can be included in the report or discussed in post-engagement meetings.

#### **Importance of Engagement Documentation**

- Ensures clarity and accountability throughout the engagement.
- Provides a structured framework for planning, execution, and post-engagement follow-up.
- Facilitates collaboration and communication between the red team and the client.

---

#### **Q&A**

**Q1: What is the purpose of the CONOPS in the Engagement Plan?**  
**A:** The CONOPS provides a non-technical overview of how the red team will meet the client’s objectives and target the client.

**Q2: What are stopping conditions in the Operations Plan?**  
**A:** Stopping conditions define the scenarios under which the red team should halt their activities during the engagement.

**Q3: What is a command playbook, and when is it used?**  
**A:** A command playbook is a detailed script of commands and tools to execute, including how, when, and why. It is typically used in larger teams with operators of varying skill levels.

**Q4: What are the two components of the Remediation Plan?**  
**A:** The two components are:

1. **Report**: A summary of engagement findings.
2. **Remediation/Consultation**: Guidance for the client on addressing vulnerabilities.

**Q5: Is the RoE always included in the Operations Plan?**  
**A:** No, the inclusion of the RoE in the Operations Plan is optional.




### **Summary: Task 6 - Concept of Operations (CONOPS)**

The Concept of Operations (CONOPS) is a high-level document that provides an overview of the red team engagement. It is included in the engagement plan and is written as a semi-technical summary for both business clients and the red team.

#### **Key Components of CONOPS**

- **Client Name**: The name of the organization commissioning the engagement.
- **Service Provider**: The red team or security service conducting the engagement.
- **Timeframe**: The duration of the engagement.
- **General Objectives/Phases**: Broad goals and key stages of the operation.
- **Training Objectives**: Specific client-requested objectives, such as assessing blue team defenses or testing exfiltration capabilities.
- **High-Level Tools/Techniques**: Tools and techniques expected to be used during the engagement.
- **Threat Group to Emulate**: If applicable, the adversary or Advanced Persistent Threat (APT) group being emulated.

The CONOPS should be straightforward, concise, and accessible to readers with minimal technical expertise. It sets the foundation for further planning and campaign details.

---

#### **Example: Holo Enterprises CONOPS**

- **Engagement Duration**: One month.
- **Persistence Requirement**: Three weeks.
- **Primary Tool**: ==Cobalt Strike==.
- **Threat Group Emulated**: FIN6.
- **Training Objectives**:
    - Test blue team's ability to detect and respond to intrusions.
    - Assess risks of adversaries within the internal network.

---

#### **Q&A**

**Q1: How long will the engagement last?**  
**A:** _One month_.

**Q2: How long is the red cell expected to maintain persistence?**  
**A:** _Three weeks_.

**Q3: What is the primary tool used within the engagement?**  
**A:** _Cobalt Strike_.






Thank you for providing the correct document! Here's a summary and the answers to the questions based on the provided resource plan:

---

### **Summary: Task 7 - Resource Plan**
#### Resource Plan

The **Resource Plan** outlines the key dates, personnel, and resource requirements for the engagement, providing a clear structure for the red team's needs. The document helps ensure all required resources are allocated efficiently and any changes can be documented.
![[Pasted image 20250113213234.png]]
#### **Details from the Resource Plan:**

- **Red Cell Lead**: Cryillic
- **Assistant Cell Lead**: Simpuki
- **Client POC**: Bean Enterprises

**Engagement Dates:**

- **Reconnaissance**: 10/04/2021 - 10/14/2021
- **Initial Access**: 10/14/2021 - 10/24/2021
- **Post-Exploitation and Persistence**: 10/24/2021 - 11/14/2021
- **Remediation**: TBD (To Be Determined)
- **Miscellaneous**: N/A

**Personnel Requirements**:

- 1 Red Cell Lead
- 1 Red Cell Assistant Lead
- 3 Red Cell Operators

**Hardware Requirements**:

- No hardware is required for this engagement. All machine resources will be allocated to the cloud.

**Cloud Requirements**:

- AWS cloud costs will be billed to the client after engagement.
- The requested budget for AWS cloud costs is **$1000**.

**Miscellaneous Requirements**:

- No other requirements are currently projected.

---

#### **Q&A**

**Q1: When will the engagement end?**  
**A1:** _11/14/2021_ (Post-exploitation and persistence phase ends).

**Q2: What is the budget the red team has for AWS cloud costs?**  
**A2:** _$1000_.

**Q3: Are there any miscellaneous requirements for the engagement?**  
**A3:** _No_.

---

Let me know if you'd like further clarifications or adjustments!




### **Summary: Task 8 - Operations Plan**


![[Pasted image 20250113214130.png]]

The **Operations Plan** outlines detailed actions and procedures for the red team during the engagement. This document expands on the CONOPS and includes specifics such as halting conditions, TTPs (Tactics, Techniques, and Procedures), and the communications plan. It plays a vital role in guiding the red team’s operations and ensuring smooth communication with the client throughout the engagement.

---

#### **Details from the Operations Plan:**

- **Red Cell Lead**: Cryillic
- **Assistant Cell Lead**: Simpuki
- **Client POC**: Bean Enterprises

**Engagement Objectives**:

- Identify system misconfigurations and network weaknesses
- Determine the effectiveness of endpoint detection and response systems
- Evaluate overall security posture and response
- Evaluate impact of data exposure and exfiltration

**Halting/Stopping Conditions**:

- System outage: All engagement operations will cease.
- Operator being "burnt": Information will be kept on a need-to-know basis.
- Discovery of an actual attack: All operations will cease and an investigation will begin.

**Communications Plan**:

- The red cell will utilize **vectr.io** for internal communication and with the client, **Bean Enterprises**.
- The client will receive daily updates on the engagement's progress and be debriefed regularly.
- If any stopping conditions are encountered, the red cell will consult with the client immediately.

**Planned TTPs and Attacks**:

- **Spearphishing** via **mshta** and **typosquatted domains** during the initial access phase.
- **Process masquerading** and **signed binary proxy execution** to assess detection capabilities.
- **C2 infrastructure** through HTTP/HTTPS protocols, data encoding, and ingress tools to sustain the engagement.
- **Domain generation algorithms** will be used to keep C2 domains and infrastructure alive.

---

#### **Q&A**

**Q1: What phishing method will be employed during the initial access phase?**  
**A1:** _Spearphishing via mshta and typosquatted domains._

**Q2: What site will be utilized for communication between the client and red cell?**  
**A2:** _vectr.io._

**Q3: If there is a system outage, will the red cell continue with the engagement?**  
**A3:** _False._

---


### **Summary : Task 8 -Mission Plan **

The mission plan is a document tailored to a specific cell, outlining the actions operators must take. It draws from previous plans and assigns relevant tasks. The format and level of detail can vary based on the team, as this is an internal document. The mission plan can be as simple as an email sent to all operators.

#### Key Elements of the Mission Plan:

- Objectives
- Operators
- Exploits/Attacks
- Targets (users, machines, or objectives)
- Execution plan variations

The operations plan focuses on the business and client perspective, while the mission plan is written from the operator and red cell's viewpoint.
![[Pasted image 20250113214207.png]]
#### **Q & A**

1. **When will the phishing campaign end?**  
    The phishing campaign will end on **10/23/2021**.
    
2. **Are you permitted to attack 10.10.6.78? (Y/N)**  
    Based on the provided mission plan, there is no mention of explicit authorization for 10.10.6.78, so you would need to consult with team leads. Without additional details, it is safer to answer **N** (No).
    
3. **When a stopping condition is encountered, you should continue working and determine the solution yourself without a team lead. (T/F)**  
    Based on the mission plan hint, the answer is **T** (True).