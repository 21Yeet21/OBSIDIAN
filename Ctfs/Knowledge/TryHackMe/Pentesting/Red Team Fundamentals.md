### **** Introduction***

- **Red Team Engagements:**
    
    - Focus on mimicking real-world adversaries to test the company's defenses against actual attacks.
    - Provide insights into the organization's ability to detect, respond to, and recover from advanced threats.
- **Limitations of Conventional Approaches:**
    
    - Vulnerability assessments and penetration tests focus on identifying technical vulnerabilities but may overlook non-technical attack vectors and real-world attack strategies.
    - Penetration tests assess vulnerabilities but may not simulate the stealthy, persistent behavior of real attackers.

---

### **Vulnerability Assessment and Penetration Test Limitations**

1. **Vulnerability Assessments:**
    
    - Goal: Identify as many vulnerabilities as possible across systems in a network.
    - Characteristics:
        - Focus on individual systems rather than the network as a whole.
        - Often automated and doesn't require advanced technical skills.
        - Security mechanisms may be relaxed for efficiency.
    - Outcome: Highlights areas for prioritized remediation but doesn't simulate attacker behavior.
2. **Penetration Tests:**
    
    - Goal: Evaluate vulnerabilities in the context of the entire network, exploring their exploitability and impact.
    - Characteristics:
        - Includes attempts to exploit vulnerabilities.
        - Evaluates how attackers might chain vulnerabilities to achieve objectives.
        - Simulates attacker movement within the network (e.g., post-exploitation and pivoting).
        - Often "loud" and may not prioritize stealth.
    - Outcome: Provides a deeper understanding of network-wide risks but lacks the realism of persistent threats.
3. **Advanced Persistent Threats (APTs):**
    
    - Description:
        - Skilled and organized threat actors, often state-sponsored or linked to criminal groups.
        - Target critical infrastructure, financial institutions, and government systems.
    - Characteristics:
        - Stealthy and persistent, remaining undetected for extended periods.
        - Exploit technical vulnerabilities, social engineering, and zero-day exploits.
    - Limitation of Conventional Methods: Vulnerability assessments and penetration tests may not prepare organizations to detect or respond to APTs effectively.

**Key Concepts:**

- **Vulnerability Assessments:** Focus on detection, not on simulating attacks.
- **Penetration Tests:** Explore exploitability but may overlook stealth and real-world tactics.
- **Real Attackers (APTs):** Persistent and resourceful, necessitating more realistic and comprehensive security evaluations (e.g., red team engagements).

###  **Red Team Engagements

1. **Purpose of Red Team Engagements:**
    
    - Simulate real-world attack scenarios to test the defensive team's (blue team) detection and response capabilities.
    - Focus on **detection and response** rather than vulnerability discovery and prevention.
    - Complement traditional penetration tests by addressing stealth, evasion, and real-world adversary techniques.
2. **Key Characteristics:**
    
    - Borrowed from military exercises, where a "red team" simulates attacks to test a "blue team's" defensive capabilities.
    - Emulates a real threat actor's **Tactics, Techniques, and Procedures (TTPs)** to mimic advanced attacks.
    - Goals are defined as **crown jewels** or **flags**, such as compromising critical systems or stealing sensitive data.
    - The blue team is typically unaware of the exercise to ensure unbiased responses.
3. **Attack Surfaces Explored:**
    
    - **Technical Infrastructure:** Focuses on uncovering vulnerabilities while prioritizing stealth and evasion.
    - **Social Engineering:** Simulates phishing, phone-based scams, or exploiting human weaknesses.
    - **Physical Intrusion:** Involves bypassing physical security measures like lockpicking or RFID cloning.
4. **Types of Engagements:**
    
    - **Full Engagement:** Simulates the entire attack lifecycle, from initial compromise to achieving the defined goals.
    - **Assumed Breach:** Begins with the assumption that attackers have already gained some access (e.g., credentials or a compromised workstation).
    - **Table-top Exercise:** Discusses theoretical attack scenarios between red and blue teams to evaluate response strategies without live simulations.
5. **Key Points:**
    
    - The main objective is **not** to find as many vulnerabilities as possible but to simulate real attacks and measure the defensive team's response.
    - Collaboration between red and blue teams helps strengthen security controls and improve detection capabilities.

**Answers to Questions:**

1. Flags are often referred to as **crown jewels** in red team engagements.
2. **TTPs** stands for **Tactics, Techniques, and Procedures**.
3. The main objective of a red team engagement is **not** to detect as many vulnerabilities in as many hosts as possible. _(Answer: Nay)_

### **Teams and Functions of an Engagement

**Overview of Cells:**

1. **Red Cell:**
    
    - Responsible for offensive operations, simulating attacks on the target system.
    - Emulates the tactics, techniques, and procedures (TTPs) of a real-world attacker.
2. **Blue Cell:**
    
    - Handles the defensive side of the engagement.
    - Composed of the defending team, which includes internal staff and defenders protecting the network.
3. **White Cell:**
    
    - Acts as the referee during the engagement.
    - Manages and monitors the engagement environment, ensures adherence to rules of engagement (ROE), and coordinates between red and blue cells.


![[Pasted image 20250113155621.png]]

**Roles within the Red Team:**

- **Red Team Lead:** Manages the engagement at a high level, plans, organizes, and delegates assignments to team members.
- **Red Team Assistant Lead:** Assists the lead in overseeing operations, engages in planning and documentation tasks.
- **Red Team Operator:** Executes the tasks assigned by the lead, interprets engagement plans, and performs the hands-on offensive work.

---

**Answers to Questions:**

1. The **Red Cell** is responsible for the offensive operations of an engagement.
2. The **Trusted Agent** is considered part of the **Blue Cell**, as they typically help defend the network or act as insiders for simulating internal threats.

### **Engagement Structure**

**Cyber Kill Chains and Their Purpose:**

these are some cyber kill chains you can check :

- [Lockheed Martin Cyber Kill Chain](https://www.lockheedmartin.com/en-us/capabilities/cyber/cyber-kill-chain.html)
- [Unified Kill Chain](https://unifiedkillchain.com/)
- [Varonis Cyber Kill Chain](https://www.varonis.com/blog/cyber-kill-chain/)
- [Active Directory Attack Cycle](https://github.com/infosecn1nja/AD-Attack-Defense)
- [MITRE ATT&CK Framework](https://attack.mitre.org/)

1. **Lockheed Martin Cyber Kill Chain:**
    
    - Focuses on the perimeter or external breach of an attack.
    - Does not cover in-depth breakdowns of internal movement but summarizes adversary behaviors and steps.
2. **Components of the Kill Chain:**
		
	 - ![[Pasted image 20250113160332.png]]
    
    - **Reconnaissance:** Gathering information on the target (e.g., harvesting emails).
    - **Weaponization:** Combining objectives with exploits, resulting in deliverables (e.g., malicious office documents).
    - **Delivery:** How the weaponized function is delivered to the target (e.g., email, USB).
    - **Exploitation:** Exploiting the target's system to execute code (e.g., MS17-010, Zero-Logon).
    - **Installation:** Installing malware or other tools (e.g., Mimikatz, Rubeus).
    - **Command & Control:** Controlling the compromised asset remotely (e.g., Empire, Cobalt Strike).
    - **Actions on Objectives:** Achieving the end objectives (e.g., ransomware, data exfiltration).

---

**Answers to Questions:**

1. If an adversary deployed **Mimikatz** on a target machine, they would be placed in the **Installation** phase of the Lockheed Martin cyber kill chain.
2. The technique's purpose to **exploit the target's system to execute code** is called **Exploitation**.


### **Story : Red Team Engagement Summary**

#### **1. Planning the Engagement**

- The **red** and **white teams** define goals aligned with the business's risk scenarios.
- The **blue team** is not informed about the engagement at this stage, allowing their natural responses to an attacker to be observed.

#### **2. Intelligence Gathering**

- The **red team** collects extensive information on the target (the bank), such as:
    - Technologies in use
    - Employee list and social media profiles
    - Publicly available photos
    - Threat intelligence on Advanced Persistent Threats (APTs)
- With this information, the red team creates a plan involving relevant **Tactics, Techniques, and Procedures (TTPs)** for the engagement. This plan is then approved by the **white team**.

#### **3. Phishing Campaign**

- The red team initiates a **phishing campaign** targeting employees using email patterns based on names found on LinkedIn.
- Example emails include:
    - "Account Suspended!!!" (malicious link for credentials)
    - "Cyber Security Training" (social engineering)
- The **blue team** detects the phishing and alerts employees, but there was no process to check for infected machines or remove malicious emails from inboxes, allowing the attack to progress.

#### **4. Exploitation and Privilege Escalation**

- The red team identifies **missing Windows patches** on **BOB-PC**, allowing the **PrintNightmare** exploit to be used.
- Using **AV evasion techniques**, the red team successfully escalates privileges to **SYSTEM** and extracts local password hashes with **mimikatz**, including the **local administrator account** "Backups."

#### **5. Lateral Movement**

- The red team attempts **Pass-the-Hash** attacks to determine if the "Backups" account can access other hosts. Attempts to connect to the **DB server** are blocked by firewall policies.
- Additional reconnaissance identifies **DBA-PC**, which is compromised, and **Pass-the-Hash** is used to pivot into the **DB server**.
- Despite alerts from the blue team, they mistakenly interpret the login attempts as part of a regular **backup process**.

#### **6. Reporting and Analysis**

- After the engagement, the **red**, **white**, and **blue teams** meet to discuss ways to improve the bank's security posture.
- Although successful techniques are the focus, failed attempts are still valuable. For example, brute force attacks against the DB server that were undetected can provide insights into the blue team's detection capabilities.
- Clear communication between teams is crucial throughout the engagement to adjust the course and ensure the exercise remains effective.